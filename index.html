<!doctype html>
<html>
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta charset="utf-8" />
    <link href="ratingsCss.css" rel="stylesheet" type="text/css" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">
    <link rel="icon" href="favicon.ico" type="image/x-icon">
    <title>Phrenzye's Ratings</title>
  </head>
  <body>
  <div class="tabs-container">
    <div class="tab active" data-tab="games">ИГРЫ</div>
    <div class="tab" data-tab="movies">ФИЛЬМЫ</div>
    <div class="tab" data-tab="series">СЕРИАЛЫ</div>
    <div class="tab hidden" data-tab="anime">АНИМЕ</div>
    <div class="tab-indicator"></div>
  </div>

  <div id="games" id="mainBlock" class="content active">
    <iframe src="ratingsGames/iframe.html" loading="lazy" id="mainFrame"></iframe>
  </div>

  <div id="movies" id="mainBlock" class="content">
    <iframe src="ratingsFilms/iframe.html" loading="lazy" id="mainFrame"></iframe>
  </div>

  <div id="series" id="mainBlock" class="content">
    <iframe src="ratingsSeries/iframe.html" loading="lazy" id="mainFrame"></iframe>
  </div>

  <div id="anime" id="mainBlock" class="content">
    <iframe src="ratingsAnime/iframe.html" loading="lazy" id="mainFrame"></iframe>
  </div>

  <script>
document.addEventListener('DOMContentLoaded', function() {
  const tabs = document.querySelectorAll('.tab');
  const tabIndicator = document.querySelector('.tab-indicator');
  const tabsContainer = document.querySelector('.tabs-container');
  
  // Переменные для отслеживания двойного нажатия
  let lastKeyPressTime = 0;
  let keyPressCount = 0;
  
  // Функция для обработки двойного нажатия
  function handleDoubleA(event) {
    // Проверяем, что нажата английская A (код 65)
    if (event.keyCode === 65 || event.key === 'a' || event.key === 'A') {
      const currentTime = new Date().getTime();
      
      // Если прошло меньше 500мс с последнего нажатия
      if (currentTime - lastKeyPressTime < 500) {
        keyPressCount++;
        
        // Если это второе нажатие (двойное)
        if (keyPressCount === 1) {
          toggleAnimeTab();
        }
      } else {
        keyPressCount = 0;
      }
      
      lastKeyPressTime = currentTime;
    }
  }
  
  // Функция для показа/скрытия таба аниме
  function toggleAnimeTab() {
    const animeTab = document.querySelector('.tab[data-tab="anime"]');
    const isHiding = !animeTab.classList.contains('hidden');
    
    animeTab.classList.toggle('hidden');
    
    // Если мы скрываем таб "аниме" и он был активен
    if (isHiding && animeTab.classList.contains('active')) {
      // Переключаемся на таб "сериалы"
      switchToTab('series');
    } else {
      // Обновляем позицию индикатора
      const activeTab = document.querySelector('.tab.active');
      if (activeTab) {
        tabIndicator.style.width = `${activeTab.offsetWidth}px`;
        tabIndicator.style.left = `${activeTab.offsetLeft}px`;
      }
    }
  }
  
  // Функция для переключения на конкретный таб
  function switchToTab(tabName) {
    document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
    document.querySelectorAll('.content').forEach(c => c.classList.remove('active'));
    
    const targetTab = document.querySelector(`.tab[data-tab="${tabName}"]`);
    const targetContent = document.getElementById(tabName);
    
    if (targetTab && targetContent) {
      targetTab.classList.add('active');
      targetContent.classList.add('active');
      
      tabIndicator.style.width = `${targetTab.offsetWidth}px`;
      tabIndicator.style.left = `${targetTab.offsetLeft}px`;
    }
  }
  
  // Добавляем обработчик события нажатия клавиш
  document.addEventListener('keydown', handleDoubleA);
  
  // Ждём полной загрузки страницы и шрифтов
  function initIndicator() {
    const activeTab = document.querySelector('.tab.active');
    if (activeTab) {
      // Добавляем небольшую задержку для гарантии
      setTimeout(() => {
        tabIndicator.style.width = `${activeTab.offsetWidth}px`;
        tabIndicator.style.left = `${activeTab.offsetLeft}px`;
        tabIndicator.style.opacity = '1'; // Делаем видимым после позиционирования
      }, 50);
    }
  }
  
  // Инициализация после полной загрузки
  if (document.readyState === 'complete') {
    initIndicator();
  } else {
    window.addEventListener('load', initIndicator);
  }
  
  // Обработчики кликов по табам
  tabs.forEach(tab => {
    tab.addEventListener('click', function() {
      const tabId = this.getAttribute('data-tab');
      switchToTab(tabId);
    });
  });

  // Функция для обработки тройного нажатия на таб "Сериалы" в мобильной версии
function initMobileTripleTap() {
  const seriesTab = document.querySelector('.tab[data-tab="series"]');
  let tapCount = 0;
  let lastTapTime = 0;
  const tapDelay = 300; // время между нажатиями в мс

  seriesTab.addEventListener('click', function(event) {
    const currentTime = new Date().getTime();
    
    // Проверяем, является ли это мобильным устройством
    const isMobile = window.innerWidth <= 768 || 
                    /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
    
    if (!isMobile) return; // Работает только на мобильных
    
    if (currentTime - lastTapTime < tapDelay) {
      tapCount++;
    } else {
      tapCount = 1;
    }
    
    lastTapTime = currentTime;
    
    if (tapCount === 3) {
      tapCount = 0; // Сбрасываем счетчик
      event.preventDefault(); // Предотвращаем обычное переключение таба
      toggleAnimeTab();
      
      // Показываем визуальную обратную связь
      seriesTab.style.backgroundColor = 'rgba(255, 255, 255, 0.2)';
      setTimeout(() => {
        seriesTab.style.backgroundColor = '';
      }, 200);
    }
  });
}
  initMobileTripleTap();
  window.addEventListener('resize', initIndicator);
});
</script>
</body>
</html>